{
  "branchName": "ralph/phase-1",
  "userStories": [
    {
      "id": "1.1",
      "title": "Project Scaffolding",
      "acceptanceCriteria": [
        "Directory structure matches ENGINEERING_GUIDE.md Section 3",
        "All __init__.py files present",
        "pyproject.toml valid and complete",
        ".env.example contains all required variables",
        "python3 -c \"import src\" succeeds"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "1.2",
      "title": "SQLite Schema",
      "acceptanceCriteria": [
        "All 6 tables created (sessions, utterances, kg_nodes, kg_edges, scoring_history, concept_elements)",
        "Foreign keys enabled and CASCADE works",
        "CHECK constraints present for data integrity",
        "JSON columns have sensible defaults",
        "All 25 verification tests pass"
      ],
      "priority": 2,
      "passes": false,
      "notes": "Migration file at src/persistence/migrations/001_initial.sql"
    },
    {
      "id": "1.3",
      "title": "Database Module",
      "acceptanceCriteria": [
        "init_database() creates database file and runs migrations",
        "get_db() provides async generator for FastAPI dependency injection",
        "get_db_connection() provides standalone connection",
        "check_database_health() returns health status",
        "Foreign keys are enforced",
        "WAL mode is enabled",
        "All 5 unit tests pass"
      ],
      "priority": 3,
      "passes": false,
      "notes": "Depends on 1.2 (schema must exist first)"
    },
    {
      "id": "1.4",
      "title": "Settings and Logging",
      "acceptanceCriteria": [
        "Settings load from environment and .env",
        "Settings validate constraints",
        "Logging outputs structured JSON format",
        "Logger context binding works",
        "Exception hierarchy is correct",
        "All 10 tests pass"
      ],
      "priority": 4,
      "passes": false,
      "notes": "Creates src/core/config.py, src/core/logging.py, src/core/exceptions.py"
    },
    {
      "id": "1.5",
      "title": "FastAPI Shell",
      "acceptanceCriteria": [
        "uvicorn src.main:app --reload starts without errors",
        "/ returns application info",
        "/health returns health status with database",
        "/health/live returns liveness status",
        "/health/ready returns readiness status",
        "All 4 integration tests pass"
      ],
      "priority": 5,
      "passes": false,
      "notes": "Creates src/main.py and health check endpoints. Depends on 1.3 and 1.4."
    },
    {
      "id": "1.6",
      "title": "Session Repository",
      "acceptanceCriteria": [
        "SessionRepository class with async methods: create, get, update_state, list_active, delete",
        "Session models use Pydantic v2 with proper validation",
        "Repository methods use aiosqlite with proper row_factory",
        "All database operations are async (no sync wrappers)",
        "Tests pass: create, get, update_state, list_active, delete"
      ],
      "priority": 6,
      "passes": false,
      "notes": "Creates src/domain/models/session.py and src/persistence/repositories/session_repo.py. Depends on 1.2 and 1.4."
    },
    {
      "id": "1.7",
      "title": "Session API Endpoints",
      "acceptanceCriteria": [
        "POST /sessions creates a new session and returns Session object",
        "GET /sessions/{id} returns session or 404 if not found",
        "DELETE /sessions/{id} deletes session or returns 404 if not found",
        "GET /sessions returns list of active sessions",
        "All endpoints handle errors with appropriate HTTP status codes",
        "Integration tests pass for all endpoints"
      ],
      "priority": 7,
      "passes": false,
      "notes": "Creates src/api/routes/sessions.py. Depends on 1.5 and 1.6."
    },
    {
      "id": "1.8",
      "title": "Integration Test",
      "acceptanceCriteria": [
        "Integration test file exists at tests/integration/test_sessions_api.py",
        "test_create_session creates session and returns valid response",
        "test_get_session retrieves created session",
        "test_get_session_not_found returns 404 for non-existent session",
        "test_list_sessions returns list of active sessions",
        "test_delete_session removes session from database",
        "test_delete_session_not_found returns 404 for non-existent session",
        "test_session_flow verifies complete lifecycle",
        "All tests pass with isolated test database",
        "Test database cleanup works (no lingering files)"
      ],
      "priority": 8,
      "passes": false,
      "notes": "Creates tests/integration/test_sessions_api.py. Depends on 1.6 and 1.7. Completes Phase 1 deliverable."
    }
  ]
}
