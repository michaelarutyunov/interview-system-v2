# Means-End Chain Methodology Configuration
#
# MEC explores chains from attributes → consequences → values
# by asking "why is that important?" to probe deeper.

methodology:
  name: means_end_chain
  description: "Means-End Chain interview methodology"

  signals:
    graph:
      - graph.node_count
      - graph.max_depth
      - graph.avg_depth
      - graph.coverage_breadth
      - graph.missing_terminal_value
      - graph.orphan_count

    llm:
      - llm.response_depth
      - llm.sentiment
      - llm.uncertainty
      - llm.hedging_language
      # Note: llm.global_response_trend is session-scoped and managed separately

    temporal:
      - temporal.strategy_repetition_count
      - temporal.turns_since_strategy_change

    meta:
      - meta.interview_progress
      - meta.interview.phase

  phases:
    early:
      description: "Initial exploration, building graph structure"
      signal_weights:
        explore: 1.5
        clarify: 1.2
        deepen: 0.5
        reflect: 0.2

    mid:
      description: "Building depth and connections"
      signal_weights:
        deepen: 1.3
        clarify: 1.0
        explore: 0.8
        reflect: 0.7

    late:
      description: "Validation and verification"
      signal_weights:
        reflect: 1.5
        validate: 1.2
        deepen: 0.5
        explore: 0.3

  strategies:
    # Strategy 1: Deepen the chain (laddering)
    - name: deepen
      technique: laddering
      signal_weights:
        # Global signals
        llm.response_depth.surface: 0.8
        llm.response_depth.moderate: 0.3
        graph.max_depth: 0.5
        graph.missing_terminal_value: 0.7
        # Node-level signals (Phase 3)
        graph.node.exhausted.false: 1.0  # Boost non-exhausted nodes
        graph.node.focus_streak.low: 0.5  # Prefer fresh nodes
        graph.node.exhaustion_score.low: 0.7  # Avoid exhausted nodes
      focus_preference: shallow

    # Strategy 2: Clarify relationships (probing)
    - name: clarify
      technique: probing
      signal_weights:
        # Global signals
        graph.orphan_count: 0.7
        graph.coverage_breadth: -0.3
        graph.edge_density: 0.6
        # Node-level signals (Phase 3)
        graph.node.is_orphan.true: 1.0  # Boost orphan nodes
        graph.node.exhausted.false: 0.5
        graph.node.focus_streak.none: 0.3
      focus_preference: related

    # Strategy 3: Explore new areas (elaboration)
    - name: explore
      technique: elaboration
      signal_weights:
        # Global signals
        graph.coverage_breadth: 0.6
        llm.uncertainty: 0.4
        temporal.strategy_repetition_count: 0.5
        # Node-level signals (Phase 3)
        graph.node.focus_streak.none: 1.0  # Fresh nodes
        graph.node.yield_stagnation.false: 0.8  # Nodes that yield
        graph.node.exhausted.false: 0.7
      focus_preference: recent

    # Strategy 4: Reflect and validate (validation)
    - name: reflect
      technique: validation
      signal_weights:
        # Global signals
        graph.max_depth: 0.7
        meta.interview_progress: 0.5
        llm.response_depth.deep: 0.6
        # Uncertainty/hedging triggers (Phase 5)
        llm.hedging_language.high: 1.0  # Trigger on high uncertainty
        llm.hedging_language.medium: 0.7  # Trigger on medium uncertainty
        meta.node.opportunity.probe_deeper: 0.6  # Extraction opportunity
        # Node-level signals (Phase 3)
        graph.node.edge_count.high: 0.8  # Well-connected nodes
        graph.node.focus_streak.high: 0.5  # Often-focused nodes
        technique.node.strategy_repetition.low: 0.3  # Avoid overusing same strategy
      focus_preference: deep

    # Strategy 5: Revitalize engagement (elaboration) - Phase 5
    - name: revitalize
      technique: elaboration
      signal_weights:
        # Fatigue detection triggers (Phase 5)
        llm.global_response_trend.fatigued: 1.0  # Trigger on fatigue
        llm.global_response_trend.shallowing: 0.5  # Prevent fatigue
        meta.node.opportunity.exhausted: 0.3  # Try exhausted nodes with new angle
        # Global signals
        graph.coverage_breadth: 0.6
        temporal.strategy_repetition_count: 0.5
        # Node-level signals (Phase 3)
        graph.node.focus_streak.none: 0.8  # Fresh nodes
        graph.node.exhausted.false: 0.5
      focus_preference: recent
